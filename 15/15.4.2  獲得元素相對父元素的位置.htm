<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>

<head>

<title></title>
<style type="text/css">
div {
    width:200px;
    height:100px;
    border:solid 1px red;
    padding:50px;
}
#wrap {
    position:relative;
    border-width:20px;
}

body {
    margin:20px;
    padding:0;
}


</style>
</head>

<body>


<div id="wrap">
    <div id="sub">
        <div id="box"></div>
    </div>
</div>


<script language="javascript" type="text/javascript">


var box = document.getElementById("box");

var o = getP(box);

alert(o.x);

//獲得指定元素距離父元素左上角的偏移坐標
//參數：e表示獲得位置的元素
//傳回值：傳回物件直接量，其中屬性x表示x軸偏移距離，屬性y表示y軸偏移距離
function getP(e){
    if(e.parentNode == e.offsetParent){ 	//判斷offsetParent屬性是否指向父級元素
        var x = e.offsetLeft; 	//如果是，則直接讀取offsetLeft屬性值
        var y = e.offsetTop ; 	//讀取offsetTop屬性值
    }
    else{	//否則呼叫getW()擴充函數獲得目前元素和父元素的x軸坐標，並傳回它們的差值
        var o = getW(e);
        var p = getW(e.parentNode);
        var x = o.x - p.x;
        var y = o.y - p.y;
    }
    return {	//傳回物件直接量，物件包含目前元素距離父元素的坐標
        "x" : x, 
        "y" : y
    }; 
}



function getW(e)
{
    var x = y = 0;
    while(e.offsetParent)
    {
        x += e.offsetLeft;
        y += e.offsetTop;
        e = e.offsetParent;
    }
    return {
        "x" : x,
        "y" : y
    }
    ;
}

</script>

</body>

</html>
